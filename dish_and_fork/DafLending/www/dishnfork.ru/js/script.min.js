"use strict";function testWebP(callback){var webP=new Image;webP.onload=webP.onerror=function(){callback(2==webP.height)},webP.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}function ibg(){let ibg=document.querySelectorAll(".ibg");for(var i=0;i<ibg.length;i++)ibg[i].querySelector("img")&&(ibg[i].style.backgroundImage="url("+ibg[i].querySelector("img").getAttribute("src")+")")}window.addEventListener("load",(function(){console.log(document),document.querySelectorAll(".hidden-on-start").forEach((function(element){element.classList.remove("hidden-on-start")}))})),testWebP((function(support){1==support?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp")})),ibg();let burgerIcon=document.querySelector(".icon-menu"),burgerMenu=document.querySelector(".menu__body"),menuLinks=document.querySelectorAll(".menu__link");if(burgerIcon){burgerIcon.addEventListener("click",(function(e){burgerIcon.classList.toggle("active"),burgerMenu.classList.toggle("active")}));for(let index=0;index<menuLinks.length;index++){const menuLink=menuLinks[index];menuLink.addEventListener("click",(function(e){burgerIcon.classList.remove("active"),burgerMenu.classList.remove("active")}))}}var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};let cakeButton=document.querySelector(".preview__btn"),cakeFirst=document.querySelector(".preview__cake_first"),cakeSecond=document.querySelector(".preview__cake_second"),cakeLeft=document.querySelector(".preview__side-cake-background");if(isMobile.any()||cakeButton&&(cakeButton.addEventListener("mouseenter",(function(e){cakeSecond.classList.remove("invisible"),cakeFirst.classList.add("invisible"),cakeLeft.classList.add("invisible")})),cakeButton.addEventListener("mouseleave",(function(e){cakeSecond.classList.add("invisible"),cakeFirst.classList.remove("invisible"),cakeLeft.classList.remove("invisible")}))),document.querySelector(".slider")){let slider=new Swiper(".slider__body",{observer:!0,observeParents:!0,slidesPerView:3,slidesPerGroup:3,spaceBetween:32,watchOverflow:!0,speed:800,loop:!0,loopAdditionalSlides:5,preloadImages:!1,parallax:!0,navigation:{nextEl:".slider .slider__arrow_next",prevEl:".slider .slider__arrow_prev"},breakpoints:{320:{slidesPerView:1,spaceBetween:15,slidesPerGroup:1},374.98:{slidesPerView:1,spaceBetween:15,slidesPerGroup:1},479.98:{slidesPerView:1,spaceBetween:15,slidesPerGroup:1},767.98:{slidesPerView:2,spaceBetween:20,slidesPerGroup:2},1110:{slidesPerView:3,spaceBetween:32,slidesPerGroup:3},1250:{slidesPerView:3,spaceBetween:32,slidesPerGroup:3}}})}!function(){let originalPositions=[],daElements=document.querySelectorAll("[data-da]"),daElementsArray=[],daMatchMedia=[];if(daElements.length>0){let number=0;for(let index=0;index<daElements.length;index++){const daElement=daElements[index],daMove=daElement.getAttribute("data-da");if(""!=daMove){const daArray=daMove.split(","),daPlace=daArray[1]?daArray[1].trim():"last",daBreakpoint=daArray[2]?daArray[2].trim():"767",daType="min"===daArray[3]?daArray[3].trim():"max",daDestination=document.querySelector("."+daArray[0].trim());daArray.length>0&&daDestination&&(daElement.setAttribute("data-da-index",number),originalPositions[number]={parent:daElement.parentNode,index:indexInParent(daElement)},daElementsArray[number]={element:daElement,destination:document.querySelector("."+daArray[0].trim()),place:daPlace,breakpoint:daBreakpoint,type:daType},number++)}}dynamicAdaptSort(daElementsArray);for(let index=0;index<daElementsArray.length;index++){const el=daElementsArray[index],daBreakpoint=el.breakpoint,daType=el.type;daMatchMedia.push(window.matchMedia("("+daType+"-width: "+daBreakpoint+"px)")),daMatchMedia[index].addListener(dynamicAdapt)}}function dynamicAdapt(e){for(let index=0;index<daElementsArray.length;index++){const el=daElementsArray[index],daElement=el.element,daDestination=el.destination,daPlace=el.place,daBreakpoint=el.breakpoint,daClassname="_dynamic_adapt_"+daBreakpoint;if(daMatchMedia[index].matches){if(!daElement.classList.contains(daClassname)){let actualIndex=indexOfElements(daDestination)[daPlace];"first"===daPlace?actualIndex=indexOfElements(daDestination)[0]:"last"===daPlace&&(actualIndex=indexOfElements(daDestination)[indexOfElements(daDestination).length]),daDestination.insertBefore(daElement,daDestination.children[actualIndex]),daElement.classList.add(daClassname)}}else daElement.classList.contains(daClassname)&&(dynamicAdaptBack(daElement),daElement.classList.remove(daClassname))}}function dynamicAdaptBack(el){const daIndex=el.getAttribute("data-da-index"),originalPlace=originalPositions[daIndex],parentPlace=originalPlace.parent,indexPlace=originalPlace.index,actualIndex=indexOfElements(parentPlace,!0)[indexPlace];parentPlace.insertBefore(el,parentPlace.children[actualIndex])}function indexInParent(el){var children;return Array.prototype.slice.call(el.parentNode.children).indexOf(el)}function indexOfElements(parent,back){const children=parent.children,childrenArray=[];for(let i=0;i<children.length;i++){const childrenElement=children[i];back?childrenArray.push(i):null==childrenElement.getAttribute("data-da")&&childrenArray.push(i)}return childrenArray}function dynamicAdaptSort(arr){arr.sort((function(a,b){return a.breakpoint>b.breakpoint?-1:1})),arr.sort((function(a,b){return a.place>b.place?1:-1}))}function customAdapt(){}dynamicAdapt()}();const popupLinks=document.querySelectorAll(".popup-link"),body=document.querySelector("body"),lockPadding=document.querySelectorAll(".lock-padding");let unlock=!0;const timeout=800;if(popupLinks.length>0)for(let index=0;index<popupLinks.length;index++){const popupLink=popupLinks[index];popupLink.addEventListener("click",(function(e){const popupName=popupLink.getAttribute("href").replace("#",""),curentPopup=document.getElementById(popupName);popupOpen(curentPopup),e.preventDefault()}))}const popupCloseIcon=document.querySelectorAll(".close-popup");if(popupCloseIcon.length>0)for(let index=0;index<popupCloseIcon.length;index++){const el=popupCloseIcon[index];el.addEventListener("click",(function(e){popupClose(el.closest(".popup")),e.preventDefault()}))}function popupOpen(curentPopup){if(curentPopup&&unlock){const popupActive=document.querySelector(".popup.open");popupActive?popupClose(popupActive,!1):bodyLock(),curentPopup.classList.add("open")}}function popupClose(popupActive,doUnlock=!0){unlock&&(popupActive.classList.remove("open"),doUnlock&&bodyUnLock())}function сloseAllPopups(){document.querySelectorAll(".popup").forEach(popupClose)}function bodyLock(){const lockPaddingValue=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(lockPadding.length>0){for(let index=0;index<lockPadding.length;index++){const el=lockPadding[index];el.style.paddingRight=lockPaddingValue}body.style.paddingRight=lockPaddingValue,body.classList.add("lock"),unlock=!1,setTimeout((function(){unlock=!0}),800)}}function bodyUnLock(){setTimeout((function(){if(lockPadding.length>0)for(let index=0;index<lockPadding.length;index++){const el=lockPadding[index];el.style.paddingRight="0px"}body.style.paddingRight="0px",body.classList.remove("lock")}),800),unlock=!1,setTimeout((function(){unlock=!0}),800)}document.addEventListener("keydown",(function(e){if(27===e.which){const popupActive=document.querySelector(".popup.open");popupClose(popupActive)}})),Element.prototype.closest||(Element.prototype.closest=function(css){for(var node=this;node;){if(node.matches(css))return node;node=node.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);let respondentClient=document.querySelector(".popup__respondent_client"),respondentCook=document.querySelector(".popup__respondent_cook"),formClient=document.querySelector(".form_client"),formCook=document.querySelector(".form_cook");document.querySelector(".popup__respondents")&&(respondentClient.addEventListener("click",(function(e){respondentClient.classList.add("active"),respondentCook.classList.remove("active"),formClient.classList.remove("invisible-item"),formCook.classList.add("invisible-item")})),respondentCook.addEventListener("click",(function(e){respondentClient.classList.remove("active"),respondentCook.classList.add("active"),formClient.classList.add("invisible-item"),formCook.classList.remove("invisible-item")})));let clientSendBtn=document.querySelector(".client-send-btn");document.querySelector(".form")&&document.addEventListener("DOMContentLoaded",(function(){const form=document.getElementById("client-form");async function formSend(e){e.preventDefault();let errorEmail=formValidateEmail(form),error=formValidate(form),formData=new FormData(form);if(console.log(form),console.log(formData),0===errorEmail&&0===error){let response;form.classList.add("_sending"),(await fetch("https://dev.dishnfork.com/api/v1/messaging/send-from-lending",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({type:"Client",name:formData.get("client-name"),email:formData.get("client-email"),message:formData.get("client-message")})})).ok?(form.reset(),form.classList.remove("_sending"),сloseAllPopups()):(alert("Ошибка"),form.classList.remove("_sending"))}}function formValidateEmail(form){let errorEmail=0,formReq=document.querySelectorAll(".req");for(let index=0;index<formReq.length;index++){const input=formReq[index];formRemoveError(input),input.classList.contains("email")&&emailTest(input)&&(formAddError(input),errorEmail++)}return errorEmail}function formValidate(form){let error=0,formReq=document.querySelectorAll(".req");for(let index=0;index<formReq.length;index++){const input=formReq[index];formRemoveError(input),input.classList.contains("email")?emailTest(input)&&(formAddError(input),error++):"checkbox"===input.getAttribute("type")&&!1===input.checked?(formAddError(input),error++):""===input.value&&(formAddError(input),error++)}return error}function formAddError(input){input.parentElement.classList.add("error"),input.classList.add("error"),clientSendBtn.classList.add("btn_disabled")}function formRemoveError(input){input.parentElement.classList.remove("error"),input.classList.remove("error"),clientSendBtn.classList.remove("btn_disabled")}function emailTest(input){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(input.value)}form.addEventListener("submit",formSend);const formImage=document.getElementById("formImage"),formPreview=document.getElementById("formPreview");function uploadFile(file){if(!["image/jpeg","image/png","image/gif"].includes(file.type))return alert("Разрешены только изображения."),void(formImage.value="");if(file.size>2097152)alert("Файл должен быть не более 2 МБ.");else{var reader=new FileReader;reader.onload=function(e){formPreview.innerHTML=`<img src="${e.target.result}" alt="Фото">`},reader.onerror=function(e){alert("Ошибка")},reader.readAsDataURL(file)}}}));let cookSendBtn=document.querySelector(".cook-send-btn");document.querySelector(".form")&&document.addEventListener("DOMContentLoaded",(function(){const form=document.getElementById("cook-form");async function formSend(e){e.preventDefault();let errorEmail=formValidateEmail(form),error=formValidate(form),formData=new FormData(form);if(0===errorEmail&&0===error){let response;form.classList.add("_sending"),(await fetch("https://dev.dishnfork.com/api/v1/messaging/send-from-lending",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({type:"Cook",name:formData.get("cook-name"),email:formData.get("cook-email"),message:formData.get("cook-message")})})).ok?(form.reset(),form.classList.remove("_sending"),сloseAllPopups()):(alert("Ошибка"),form.classList.remove("_sending"))}}function formValidateEmail(form){let errorEmail=0,formReq=document.querySelectorAll(".req-1");for(let index=0;index<formReq.length;index++){const input=formReq[index];formRemoveError(input),input.classList.contains("email-1")&&emailTest(input)&&(formAddError(input),errorEmail++)}return errorEmail}function formValidate(form){let error=0,formReq=document.querySelectorAll(".req-1");for(let index=0;index<formReq.length;index++){const input=formReq[index];formRemoveError(input),input.classList.contains("email-1")?emailTest(input)&&(formAddError(input),error++):"checkbox"===input.getAttribute("type")&&!1===input.checked?(formAddError(input),error++):""===input.value&&(formAddError(input),error++)}return error}function formAddError(input){input.parentElement.classList.add("error"),input.classList.add("error"),cookSendBtn.classList.add("btn_disabled")}function formRemoveError(input){input.parentElement.classList.remove("error"),input.classList.remove("error"),cookSendBtn.classList.remove("btn_disabled")}function emailTest(input){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(input.value)}form.addEventListener("submit",formSend);const formImage=document.getElementById("formImage"),formPreview=document.getElementById("formPreview");function uploadFile(file){if(!["image/jpeg","image/png","image/gif"].includes(file.type))return alert("Разрешены только изображения."),void(formImage.value="");if(file.size>2097152)alert("Файл должен быть не более 2 МБ.");else{var reader=new FileReader;reader.onload=function(e){formPreview.innerHTML=`<img src="${e.target.result}" alt="Фото">`},reader.onerror=function(e){alert("Ошибка")},reader.readAsDataURL(file)}}}));